https://drive.google.com/drive/folders/1_CaRcTbOsJmPu4x_LRSKJAqwTnJuc4bJ?usp=drive_link

USE [Base de datos Adventure];
GO

-- CONSULTA 1: SELECT + WHERE + ORDER BY + CASE + SUBCONSULTA
-- Productos entre 100 y 500, con CASE para mostrar color
-- y una subconsulta que cuenta cuántas veces se vendió

SELECT p.ProductID,
p.Name AS Producto,
p.ListPrice,
CASE
WHEN p.Color IS NULL THEN 'Sin color'
ELSE p.Color
END AS EstadoColor,
(SELECT COUNT(*)
FROM Sales.SalesOrderDetail sod
WHERE sod.ProductID = p.ProductID) AS VecesVendido
FROM Production.Product p
WHERE p.ListPrice BETWEEN 100 AND 500
AND p.Color IN ('Red', 'Black', 'Silver')
ORDER BY VecesVendido DESC;


-- CONSULTA 2: INNER JOIN
-- Empleados con su nombre completo, puesto y departamento

SELECT e.BusinessEntityID,
p.FirstName + ' ' + p.LastName AS Empleado,
e.JobTitle,
d.Name AS Departamento
FROM HumanResources.Employee e
INNER JOIN Person.Person p
ON e.BusinessEntityID = p.BusinessEntityID
INNER JOIN HumanResources.EmployeeDepartmentHistory edh
ON e.BusinessEntityID = edh.BusinessEntityID
INNER JOIN HumanResources.Department d
ON edh.DepartmentID = d.DepartmentID
WHERE e.BirthDate > '1980-01-01'
ORDER BY d.Name;


-- CONSULTA 3: LEFT JOIN + IS NULL
-- Clientes que no tienen pedidos

SELECT c.CustomerID,
p.FirstName + ' ' + p.LastName AS Cliente,
so.SalesOrderID
FROM Sales.Customer c
INNER JOIN Person.Person p
ON c.PersonID = p.BusinessEntityID
LEFT JOIN Sales.SalesOrderHeader so
ON c.CustomerID = so.CustomerID
WHERE so.SalesOrderID IS NULL;


-- CONSULTA 4: RIGHT JOIN
-- Pedidos con información de sus vendedores (aunque no haya coincidencia)

SELECT soh.SalesOrderID, sp.BusinessEntityID, p.FirstName, p.LastName
FROM Sales.SalesOrderHeader soh
RIGHT JOIN Sales.SalesPerson sp
ON soh.SalesPersonID = sp.BusinessEntityID
INNER JOIN Person.Person p
ON sp.BusinessEntityID = p.BusinessEntityID;


-- CONSULTA 5: FULL JOIN
-- Comparar productos con sus ventas (incluso si no hay ventas)

SELECT p.ProductID, p.Name AS Producto, sod.SalesOrderID
FROM Production.Product p
FULL JOIN Sales.SalesOrderDetail sod
ON p.ProductID = sod.ProductID;


-- CONSULTA 6: CROSS JOIN
-- Combinación de 5 productos y 5 monedas (ejemplo de combinatoria)

SELECT TOP 5 p.Name AS Producto, c.Name AS Moneda
FROM Production.Product p
CROSS JOIN Sales.Currency c;



-- CONSULTA 7: GROUP BY + HAVING + Funciones de grupo
-- Cantidad de pedidos por cliente, solo los que tienen más de 5 pedidos

SELECT c.CustomerID,
COUNT(soh.SalesOrderID) AS CantidadPedidos
FROM Sales.Customer c
INNER JOIN Sales.SalesOrderHeader soh
ON c.CustomerID = soh.CustomerID
GROUP BY c.CustomerID
HAVING COUNT(soh.SalesOrderID) > 5;


-- CONSULTA 8: EXISTS / NOT EXISTS
-- Productos que sí tienen ventas registradas

SELECT p.ProductID, p.Name
FROM Production.Product p
WHERE EXISTS (
SELECT 1
FROM Sales.SalesOrderDetail sod
WHERE sod.ProductID = p.ProductID
);

-- Productos que nunca se han vendido
SELECT p.ProductID, p.Name
FROM Production.Product p
WHERE NOT EXISTS (
SELECT 1
FROM Sales.SalesOrderDetail sod
WHERE sod.ProductID = p.ProductID
);


-- CONSULTA 9: Subconsulta con IN
-- Clientes que han realizado al menos un pedido mayor a 5000

SELECT c.CustomerID, p.FirstName, p.LastName
FROM Sales.Customer c
INNER JOIN Person.Person p
ON c.PersonID = p.BusinessEntityID
WHERE c.CustomerID IN (
SELECT CustomerID
FROM Sales.SalesOrderHeader
WHERE TotalDue > 5000
);


-- CONSULTA 10: UNION
-- Lista de apellidos que empiezan con S o T

SELECT LastName AS Apellido
FROM Person.Person
WHERE LastName LIKE 'S%'
UNION
SELECT LastName
FROM Person.Person
WHERE LastName LIKE 'T%'
ORDER BY Apellido;

